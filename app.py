from flask import Flask, render_template, request, jsonify

app = Flask(__name__)

responses = {
    "что ты умеешь": "Я могу отвечать на ваши вопросы.",
    "привет": "Здравствуйте! Чем я могу помочь?",
    "как дела": "У меня всё отлично, спасибо!",
    "который час": "Извините, сейчас я не умею говорить о времени.",
    "что такое алгебра": "Алгебра — раздел математики, изучающий свойства чисел и алгебраические операции.",
    "что изучает история": "История изучает прошлое человечества, важные события и их влияние на развитие общества.",
    "что такое геометрия": "Геометрия — раздел математики, изучающий фигуры, их свойства и размеры.",
    "что такое физика": "Физика — наука о природе, её законах и явлениях.",
    "что такое биология": "Биология — наука о живых организмах.",
    "кто написал 'войну и мир'": "Лев Толстой написал 'Войну и мир'.",
    "что такое химия": "Химия — наука, изучающая вещества, их свойства и превращения.",
    "что изучает экономика": "Экономика — наука о производстве, распределении и потреблении товаров и услуг.",
    "что такое программа": "Программа — последовательность инструкций для компьютера.",
    "что такое математика": "Математика — наука о числах, формах и структурах.",
    "что такое литература": "Литература — искусство слова и его произведения.",
    "как научиться быстро читать": "Практикуйте скорочтение, сокращайте регресс и повторяйте прочитанное.",
    "что такое анатомия": "Анатомия — наука о строении органов и систем организма.",
    "что такое право": "Право — система норм, регулирующих отношения в обществе.",
    "что такое психология": "Психология — наука о душе и поведении человека.",
    "что такое философия": "Философия — наука о смысле жизни, бытии и знании.",
    "что такое информатика": "Информатика — наука о хранении, обработке и передаче информации.",
    "что такое инженерия": "Инженерия — прикладная наука о создании технических устройств.",
    "как подготовиться к экзамену": "Планируйте подготовку, повторяйте и решайте тесты.",
    "что такое экологическая наука": "Изучает взаимодействие человека и среды.",
    "что такое социология": "Наука о социумe и обществе.",
    "какие бывают виды мышления": "Аналитическое, креативное, критическое и системное.",
    "что значит быть успешным": "Достижение целей и личностный рост."
}

def get_bot_response(user_input):
    # приводим вопрос к нижнему регистру и убираем лишние пробелы
    question = user_input.lower().strip()
    # ищем точное совпадение
    answer = responses.get(question)
    if answer:
        return answer
    else:
        # дополнительно — искать по ключевым словам
        for key in responses:
            if key in question:
                return responses[key]
        return "Я вас не понял. Попробуйте ещё раз."

@app.route("/")
def index():
    return render_template("index.html")

@app.route("/ask", methods=["POST"])
def ask():
    data = request.get_json()
    question = data.get("question", "")
    answer = get_bot_response(question)
    is_html = "<ul>" in answer or "<br>" in answer or "&laquo;" in answer
    return jsonify({"answer": answer, "html": is_html})

if __name__ == "__main__":
    app.run(debug=True)